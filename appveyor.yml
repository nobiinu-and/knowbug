# AppVeyor <https://ci.appveyor.com>

version: 2.0.{build}

image: Visual Studio 2019

environment:
  KNOWBUG_MSBUILD: "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\MSBuild.exe"

build_script:
- ps: |
    ./scripts/build-all.ps1
    if (!$?) {
        exit 1
    }

test_script:
- ps1: |
    ./scripts/test-all.ps1
    if (!$?) {
        exit 1
    }

    ./scripts/pack.ps1
    if (!$?) {
        exit 1
    }

artifacts:
- path: knowbug-*.zip
  name: knowbug-zip

deploy:
- provider: GitHub
  auth_token:
    # <https://ci.appveyor.com/tools/encrypt> で暗号化された GitHub アクセストークン
    secure: UPvfs/H6O/PP0V+a0zA1qvQuHYxlqr0nw9Mn+fUdoZWtR2XITfP4hoelCR4CY65O
  artifact: /knowbug-([\d.]+)\.zip/
  prerelease: true
  on:
    branch: /master|release/
